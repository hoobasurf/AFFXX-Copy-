
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inscription</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet"/>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }

  html, body {
    height: 100%;
    width: 100%;
    font-family: 'Orbitron', sans-serif;
    background: url("ville.jpg") no-repeat center center/cover;
    color: #fff;
    overflow-y: auto;          /* ‚úÖ scroll activ√© globalement */
    -webkit-overflow-scrolling: touch; /* scroll fluide iPhone */
  }

  body {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    padding-bottom: 40px; /* espace pour boutons visibles */
  }

  .container {
    background: rgba(0,0,0,0.4);
    padding: 20px;
    border-radius: 15px;
    width: 95%;
    max-width: 500px;
    margin: 40px auto;
    box-shadow: 0 0 20px #ff66cc;
    text-align: center;
    position: relative;
    z-index: 1;
  }

  h1 {
    color: #ff66cc;
    text-shadow: 0 0 10px #ff66cc;
    margin-bottom: 15px;
  }

  input, textarea {
    width: 100%;
    margin: 10px 0;
    padding: 10px;
    border-radius: 8px;
    border: 2px solid #ff66cc;
    background: rgba(0,0,0,0.5);
    color: #fff;
  }

  .salles {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    margin: 10px 0;
  }

  .salle-btn {
    padding: 8px 15px;
    border: 2px solid #ff66cc;
    border-radius: 10px;
    background: rgba(0,0,0,0.4);
    color: #fff;
    cursor: pointer;
    font-weight: bold;
    transition: 0.3s;
  }

  .salle-btn.active {
    box-shadow: 0 0 15px #ff66cc, 0 0 25px #ff66cc inset;
    background: rgba(255, 102, 204,0.8);
  }

  .photos-preview {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin-top: 10px;
  }

  .photos-preview img {
    width: 70px;
    height: 70px;
    object-fit: cover;
    border-radius: 8px;
    border: 2px solid #ff66cc;
    cursor: pointer;
    transition: transform 0.2s;
  }

  .photos-preview img:hover {
    transform: scale(1.2);
  }

  button.signup-btn, button.login-btn {
    margin: 10px;
    padding: 10px 20px;
    border-radius: 8px;
    border: 2px solid #ff66cc;
    background: rgba(0,0,0,0.4);
    color: #fff;
    cursor: pointer;
    font-size: 1em;
    text-transform: uppercase;
    box-shadow: 0 0 10px #ff66cc, 0 0 20px #ff66cc inset;
    transition: 0.3s;
  }

  button.signup-btn:hover, button.login-btn:hover {
    box-shadow: 0 0 20px #ff66cc, 0 0 30px #ff66cc inset;
  }

  .lightbox {
    display: none;
    position: fixed;
    z-index: 10000;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.9);
    justify-content: center;
    align-items: center;
  }

  .lightbox img {
    max-width: 90%;
    max-height: 90%;
    border-radius: 10px;
    box-shadow: 0 0 25px #ff66cc;
  }

  #vortexOverlay {
    position: fixed;
    top:0; left:0;
    width:100%; height:100%;
    display: none;
    justify-content: center;
    align-items: center;
    background: transparent;
    z-index: 2000;
    overflow: hidden;
  }

  .vortex {
    width: 200vw;
    height: 200vw;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255,102,204,0.2) 20%, transparent 70%);
    animation: spinZoom 2s ease-in-out forwards;
  }

  @keyframes spinZoom {
    0% { transform: scale(0) rotate(0deg); opacity: 1; }
    70% { transform: scale(2) rotate(720deg); opacity: 1; }
    100% { transform: scale(4) rotate(1440deg); opacity: 0; }
  }

  #whiteFlash {
    position: fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:white;
    opacity:0;
    z-index:3000;
    pointer-events:none;
    transition: opacity 0.4s ease-in-out;
  }
</style>
</head>
<body>

<div class="container">
  <h1>Inscription</h1>
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Mot de passe">
  <input type="text" id="pseudo" placeholder="Pseudo">
  <input type="number" id="age" placeholder="√Çge">
  <input type="text" id="location" placeholder="Lieu">
  <textarea id="description" placeholder="Description..."></textarea>

  <div class="salles">
    <div class="salle-btn" data-value="serieux">S√©rieux</div>
    <div class="salle-btn" data-value="amicale">Amicale</div>
    <div class="salle-btn" data-value="fun">Fun</div>
  </div>

  <label for="photos">Ajoute jusqu‚Äô√† 5 photos :</label>
  <input type="file" id="photos" accept="image/*" multiple>
  <div class="photos-preview" id="photosPreview"></div>

  <button class="signup-btn" id="signupBtn">S‚Äôinscrire</button>
  <button class="login-btn" id="loginBtn">Se connecter</button>
</div>

<div class="lightbox" id="lightbox"><img id="lightboxImg" src=""></div>
<div id="vortexOverlay"><div class="vortex"></div></div>
<div id="whiteFlash"></div>

<script type="module">
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";
import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-database.js";
import { app } from "./firebase.js";

const auth = getAuth(app);
const db = getDatabase(app);

const email = document.getElementById("email");
const password = document.getElementById("password");
const pseudo = document.getElementById("pseudo");
const age = document.getElementById("age");
const locationInput = document.getElementById("location");
const description = document.getElementById("description");
const photosInput = document.getElementById("photos");
const preview = document.getElementById("photosPreview");
const signupBtn = document.getElementById("signupBtn");
const loginBtn = document.getElementById("loginBtn");
const lightbox = document.getElementById("lightbox");
const lightboxImg = document.getElementById("lightboxImg");
const vortexOverlay = document.getElementById("vortexOverlay");
const whiteFlash = document.getElementById("whiteFlash");

let uploadedPhotos = [];

photosInput.addEventListener("change", e=>{
  preview.innerHTML = "";
  uploadedPhotos=[];
  [...e.target.files].slice(0,5).forEach(file=>{
    const reader = new FileReader();
    reader.onload=ev=>{
      const img=document.createElement("img");
      img.src=ev.target.result;
      img.addEventListener("click", ()=> {
        lightboxImg.src = ev.target.result;
        lightbox.style.display = "flex";
      });
      preview.appendChild(img);
    }
    reader.readAsDataURL(file);
    uploadedPhotos.push(file);
  });
});

lightbox.addEventListener("click", ()=>{
  lightbox.style.display="none";
  lightboxImg.src="";
});

const salleBtns = document.querySelectorAll(".salle-btn");
let selectedRooms = [];
salleBtns.forEach(btn=>{
  btn.addEventListener("click", ()=>{
    const val = btn.dataset.value;
    if(selectedRooms.includes(val)){
      selectedRooms = selectedRooms.filter(r=>r!==val);
      btn.classList.remove("active");
    } else {
      selectedRooms.push(val);
      btn.classList.add("active");
    }
  });
});

function playVortexAndRedirect() {
  vortexOverlay.style.display = "flex";
  setTimeout(()=>{
    whiteFlash.style.opacity = "1";
    setTimeout(()=> window.location.href="page2.html", 400);
  },1800);
}

signupBtn.addEventListener("click", async ()=>{
  if(!email.value || !password.value) { alert("Email et mot de passe requis"); return; }
  try{
    const userCred = await createUserWithEmailAndPassword(auth,email.value,password.value);
    const user = userCred.user;
    const photoURLs = uploadedPhotos.map(file=>URL.createObjectURL(file));
    await set(ref(db,"users/"+user.uid),{
      email: email.value,
      pseudo: pseudo.value,
      age: age.value,
      location: locationInput.value,
      description: description.value,
      rooms: selectedRooms,
      photos: photoURLs,
      online: false,
      gender: "girl"
    });
    playVortexAndRedirect();
  } catch(e){
    alert("Erreur: "+e.message);
  }
});

loginBtn.addEventListener("click", async ()=>{
  try{
    await signInWithEmailAndPassword(auth,email.value,password.value);
    playVortexAndRedirect();
  }catch(e){
    alert("Erreur: "+e.message);
  }
});
</script>
</body>
</html>




Page2:

<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Mon Profil</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet"/>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%;width:100%;font-family:'Orbitron',sans-serif;background:url('ville.jpg') no-repeat center center/cover;background-attachment:fixed;color:#fff;overflow-y:auto;scroll-behavior:smooth}
  .container{max-width:600px;margin:30px auto;background:rgba(0,0,0,0.6);padding:24px;border-radius:15px;box-shadow:0 0 20px #ff66cc;text-align:center}
  h1{color:#ff66cc;text-shadow:0 0 10px #ff66cc;margin-bottom:12px}
  .info{margin-bottom:12px;text-align:left}
  .info div{margin:8px 0}
  .main-photo{width:100%;max-height:360px;object-fit:cover;border-radius:10px;border:2px solid #ff66cc;cursor:pointer}
  .photos{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:12px}
  .photos img{width:70px;height:70px;object-fit:cover;border-radius:8px;border:2px solid #ff66cc;cursor:pointer;transition:transform .15s}
  .photos img:hover{transform:scale(1.15)}
  .room-btn{padding:10px 20px;margin:8px;border:2px solid #ff66cc;background:rgba(0,0,0,0.4);color:#fff;border-radius:8px;cursor:pointer;box-shadow:0 0 10px #ff66cc,0 0 20px #ff66cc inset}
  .edit-btn{margin-top:10px;padding:8px 14px;border-radius:8px;border:2px solid #ff66cc;background:rgba(0,0,0,0.4);color:#fff;cursor:pointer}
  .lightbox{display:none;position:fixed;z-index:10000;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.92);display:flex;align-items:center;justify-content:center}
  .lightbox img{max-width:92%;max-height:92%;border-radius:10px;box-shadow:0 0 25px #ff66cc}
  .modal{display:none;position:fixed;z-index:12000;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.75);align-items:center;justify-content:center}
  .modal .box{background:rgba(0,0,0,0.6);padding:18px;border-radius:12px;width:90%;max-width:480px;box-shadow:0 0 20px #ff66cc}
  .modal input, .modal textarea{width:100%;margin:8px 0;padding:8px;border-radius:8px;border:2px solid #ff66cc;background:rgba(0,0,0,0.4);color:#fff}
  .modal .row{display:flex;gap:8px}
  .modal button{flex:1;padding:10px;border-radius:8px;border:2px solid #ff66cc;background:rgba(0,0,0,0.4);color:#fff;cursor:pointer}
  #onlineCarouselContainer{max-width:600px;margin:30px auto;background:rgba(0,0,0,0.6);padding:16px;border-radius:15px;box-shadow:0 0 20px #ff66cc;text-align:left}
  #onlineCarousel{display:flex;overflow-x:auto;gap:10px;padding-top:8px;padding-bottom:8px}
  .onlineCard{min-width:100px;text-align:center;color:#fff;font-family:'Orbitron',sans-serif}
  .onlineCard img{width:100px;height:100px;object-fit:cover;border-radius:10px;border:2px solid #ff66cc;cursor:pointer}
  .onlineCard span{display:block;margin-top:4px;font-size:0.9em}
</style>
</head>
<body>
  <div class="container">
    <h1>Mon Profil</h1>

    <div class="info">
      <div><strong>Pseudo :</strong> <span id="pseudo">Non renseign√©</span></div>
      <div><strong>√Çge :</strong> <span id="age">Non renseign√©</span></div>
      <div><strong>Lieu :</strong> <span id="location">Non renseign√©</span></div>
      <div><strong>Description :</strong> <span id="description">Non renseign√©e</span></div>
    </div>

    <img id="mainPhoto" class="main-photo" src="https://via.placeholder.com/800x360?text=Photo" alt="Photo principale">
    <div class="photos" id="photosContainer"></div>
    <div id="roomButtons" style="margin-top:12px"></div>
    <button id="editBtn" class="edit-btn">Modifier</button>
  </div>

  <div id="onlineCarouselContainer">
    <h2 style="color:#ff66cc;text-shadow:0 0 10px #ff66cc;margin-bottom:8px">Utilisateurs en ligne</h2>
    <div id="onlineCarousel"></div>
  </div>

  <div class="lightbox" id="lightbox"><img id="lightboxImg" src=""></div>

  <div class="modal" id="modalEdit">
    <div class="box">
      <h3 style="color:#ff66cc;margin-bottom:8px">Modifier description / photos</h3>
      <textarea id="editDescription" rows="3" placeholder="Nouvelle description..."></textarea>
      <input type="file" id="editPhotos" accept="image/*" multiple>
      <div class="photos" id="editPreview"></div>
      <div class="row" style="margin-top:10px">
        <button id="saveEdit">Enregistrer</button>
        <button id="cancelEdit">Annuler</button>
      </div>
    </div>
  </div>

<script type="module">
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";
import { getDatabase, ref, get, update, set, onDisconnect, onValue } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-database.js";
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";

const firebaseConfig = {
  apiKey: "AIzaSyAbI0fvcv9lIzpPViVBx2BlO8c6L3w-rbc",
  authDomain: "affxx-copy.firebaseapp.com",
  databaseURL: "https://affxx-copy-default-rtdb.firebaseio.com",
  projectId: "affxx-copy",
  storageBucket: "affxx-copy.appspot.com",
  messagingSenderId: "763273288933",
  appId: "1:763273288933:web:d0083f5f6ab7284661c80c"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);

// üîπ Attente de la v√©rification utilisateur
onAuthStateChanged(auth, async user => {
  if (!user) {
    console.warn("‚ö†Ô∏è Aucun utilisateur actif, redirection vers inscription...");
    window.location.href = "inscription.html";
    return;
  }

  const currentUid = user.uid;
  const userRef = ref(db, "users/" + currentUid);

  const userStatusRef = ref(db, "users/" + currentUid + "/online");
  set(userStatusRef, true);
  onDisconnect(userStatusRef).set(false);

  // üîπ Charger le profil complet
  const snap = await get(userRef);
  if (snap.exists()) {
    const data = snap.val();

    document.getElementById("pseudo").textContent = data.pseudo || "Non renseign√©";
    document.getElementById("age").textContent = data.age || "Non renseign√©";
    document.getElementById("location").textContent = data.location || "Non renseign√©";
    document.getElementById("description").textContent = data.description || "Non renseign√©e";

    // üîπ Charger les photos (corrig√©)
    const photosContainer = document.getElementById("photosContainer");
    photosContainer.innerHTML = "";
    const currentPhotos = data.photos && Array.isArray(data.photos) ? data.photos : [];

    if (currentPhotos.length > 0) {
      document.getElementById("mainPhoto").src = currentPhotos[0];
      currentPhotos.forEach(url => {
        const img = document.createElement("img");
        img.src = url;
        img.addEventListener("click", () => openLightbox(url));
        photosContainer.appendChild(img);
      });
    } else {
      document.getElementById("mainPhoto").src = "https://via.placeholder.com/800x360?text=Aucune+photo";
    }

    // üîπ Boutons de salles
    const roomButtons = document.getElementById("roomButtons");
    roomButtons.innerHTML = "";
    (data.rooms || []).forEach(room => {
      const btn = document.createElement("button");
      btn.className = "room-btn";
      btn.textContent = room.charAt(0).toUpperCase() + room.slice(1);
      btn.addEventListener("click", () => {
        const pageMap = {
          serieux: "authentique.html",
          amicale: "amicale.html",
          fun: "fun.html"
        };
        const target = pageMap[room.toLowerCase()];
        if (target) window.location.href = target;
      });
      roomButtons.appendChild(btn);
    });
  }

  // üîπ Carrousel en ligne
  const usersRef = ref(db, "users");
  onValue(usersRef, snapshot => {
    const users = snapshot.val();
    const onlineCarousel = document.getElementById("onlineCarousel");
    onlineCarousel.innerHTML = "";
    if (!users) return;
    Object.keys(users).forEach(uid => {
      const u = users[uid];
      if (u.online && uid !== currentUid) {
        const card = document.createElement("div");
        card.className = "onlineCard";
        const img = document.createElement("img");
        img.src = (u.photos && u.photos[0]) || "https://via.placeholder.com/100";
        const span = document.createElement("span");
        span.textContent = u.pseudo || "Utilisateur";
        img.addEventListener("click", () => alert(`Pseudo: ${u.pseudo}\n√Çge: ${u.age || "Non renseign√©"}\nLieu: ${u.location || "Non renseign√©"}`));
        card.appendChild(img);
        card.appendChild(span);
        onlineCarousel.appendChild(card);
      }
    });
  });
});

function openLightbox(src) {
  const lightbox = document.getElementById("lightbox");
  const lightboxImg = document.getElementById("lightboxImg");
  lightboxImg.src = src;
  lightbox.style.display = "flex";
}
document.getElementById("lightbox").addEventListener("click", () => {
  document.getElementById("lightbox").style.display = "none";
});
</script>
</body>
</html>
