<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Affinix – Authentique</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: url('https://i.imgur.com/lc0N6kH.jpeg') no-repeat center center fixed;
      background-size: cover;
      color: white;
    }

    .carousel {
      display: flex;
      overflow-x: auto;
      padding: 20px;
      scroll-behavior: smooth;
    }

    .card {
      min-width: 220px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid #ff66cc;
      border-radius: 15px;
      margin-right: 20px;
      padding: 15px;
      text-align: center;
      position: relative;
    }

    .card img {
      width: 100%;
      border-radius: 12px;
    }

    .btns {
      margin-top: 10px;
    }

    .btn {
      border: none;
      padding: 8px 12px;
      margin: 0 5px;
      cursor: pointer;
      border-radius: 5px;
    }

    .btn-like.active {
      background-color: gold;
      color: black;
    }

    .leftBar {
      position: fixed;
      top: 60px;
      left: 10px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 1000;
    }

    .leftBar img {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid #ff66cc;
      transition: transform 0.2s;
      position: relative;
    }

    .leftBar img:active {
      transform: scale(0.9);
    }

    #chatBox {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0,0,0,0.8);
      padding: 10px;
      display: none;
    }

    #chatMessages {
      max-height: 120px;
      overflow-y: auto;
      margin-bottom: 5px;
    }

    #chatInput {
      width: 80%;
      padding: 8px;
      border-radius: 5px;
      border: none;
    }

    #sendBtn {
      padding: 8px 12px;
      border-radius: 5px;
      border: none;
      background: #ff66cc;
      color: white;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div class="leftBar" id="miniProfiles"></div>

<div class="carousel" id="carousel">
  <div class="card" data-name="Léna" data-img="https://i.pravatar.cc/150?img=12">
    <img src="https://i.pravatar.cc/150?img=12" alt="Léna">
    <h3>Léna</h3>
    <p>25 ans – Paris</p>
    <div class="btns">
      <button class="btn btn-like">⭐</button>
      <button class="btn btn-message">Message</button>
    </div>
  </div>
  <div class="card" data-name="Sara" data-img="https://i.pravatar.cc/150?img=5">
    <img src="https://i.pravatar.cc/150?img=5" alt="Sara">
    <h3>Sara</h3>
    <p>28 ans – Lyon</p>
    <div class="btns">
      <button class="btn btn-like">⭐</button>
      <button class="btn btn-message">Message</button>
    </div>
  </div>
</div>

<div id="chatBox">
  <div id="chatMessages"></div>
  <input type="text" id="chatInput" placeholder="Écris un message...">
  <button id="sendBtn">Envoyer</button>
</div>

<script>
  const likeButtons = document.querySelectorAll('.btn-like');
  const messageButtons = document.querySelectorAll('.btn-message');
  const miniProfiles = document.getElementById('miniProfiles');
  const chatBox = document.getElementById('chatBox');
  const chatMessages = document.getElementById('chatMessages');
  const chatInput = document.getElementById('chatInput');
  const sendBtn = document.getElementById('sendBtn');

  let currentChatName = null;
  const chats = {};

  likeButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      btn.classList.toggle('active');
    });
  });

  messageButtons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      const card = e.target.closest('.card');
      const name = card.dataset.name;
      const imgSrc = card.dataset.img;

      if (!document.querySelector(`#miniProfiles img[alt="${name}"]`)) {
        const img = document.createElement('img');
        img.src = imgSrc;
        img.alt = name;
        img.title = name;
        miniProfiles.appendChild(img);

        let timer;
        img.addEventListener('mousedown', () => {
          timer = setTimeout(() => {
            miniProfiles.removeChild(img);
            if (currentChatName === name) {
              chatBox.style.display = 'none';
              currentChatName = null;
            }
          }, 3000);
        });

        img.addEventListener('mouseup', () => clearTimeout(timer));

        img.addEventListener('click', () => {
          currentChatName = name;
          chatMessages.innerHTML = (chats[name] || []).map(m => `<div>${m}</div>`).join('');
          chatBox.style.display = 'block';
        });

        // Drag
        let isDragging = false, startX, startY;
        img.addEventListener('mousedown', (e) => {
          isDragging = true;
          startX = e.clientX - img.offsetLeft;
          startY = e.clientY - img.offsetTop;
          img.style.position = 'absolute';
        });
        document.addEventListener('mousemove', (e) => {
          if (isDragging) {
            img.style.left = (e.clientX - startX) + 'px';
            img.style.top = (e.clientY - startY) + 'px';
          }
        });
        document.addEventListener('mouseup', () => isDragging = false);
      }

      currentChatName = name;
      chatMessages.innerHTML = (chats[name] || []).map(m => `<div>${m}</div>`).join('');
      chatBox.style.display = 'block';
    });
  });

  sendBtn.addEventListener('click', () => {
    const msg = chatInput.value.trim();
    if (!msg || !currentChatName) return;
    if (!chats[currentChatName]) chats[currentChatName] = [];
    chats[currentChatName].push(msg);
    chatMessages.innerHTML += `<div>${msg}</div>`;
    chatInput.value = '';
  });
</script>

</body>
</html>
